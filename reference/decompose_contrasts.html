<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Decompose contrasts into new columns — decompose_contrasts • contrastable</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Decompose contrasts into new columns — decompose_contrasts"><meta name="description" content="Given a dataframe with factor columns, this function will extract the
contrasts from the factor column and place them inside new columns. This is
useful for cases where you want to work with the numeric values of the
contrasts. For a pedagogical example, you can explicitly show how factor
variables are transformed into numeric values. For a practical example,
you're typically allowed n-1 contrasts for n levels of a factor. If you don't
want to use all of the contrasts, you can extract the ones you want and use
them in your model. This is sometimes used with polynomial contrasts when you
don't want to use higher order polynomials."><meta property="og:description" content="Given a dataframe with factor columns, this function will extract the
contrasts from the factor column and place them inside new columns. This is
useful for cases where you want to work with the numeric values of the
contrasts. For a pedagogical example, you can explicitly show how factor
variables are transformed into numeric values. For a practical example,
you're typically allowed n-1 contrasts for n levels of a factor. If you don't
want to use all of the contrasts, you can extract the ones you want and use
them in your model. This is sometimes used with polynomial contrasts when you
don't want to use higher order polynomials."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">contrastable</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.2.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/contrasts.html">Contrastable Overview</a></li>
    <li><a class="dropdown-item" href="../articles/warnings.html">Warnings, Messages, and Errors</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/tsostarics/contrastable/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Decompose contrasts into new columns</h1>
      <small class="dont-index">Source: <a href="https://github.com/tsostarics/contrastable/blob/main/R/decompose_contrasts.R" class="external-link"><code>R/decompose_contrasts.R</code></a></small>
      <div class="d-none name"><code>decompose_contrasts.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Given a dataframe with factor columns, this function will extract the
contrasts from the factor column and place them inside new columns. This is
useful for cases where you want to work with the numeric values of the
contrasts. For a pedagogical example, you can explicitly show how factor
variables are transformed into numeric values. For a practical example,
you're typically allowed n-1 contrasts for n levels of a factor. If you don't
want to use all of the contrasts, you can extract the ones you want and use
them in your model. This is sometimes used with polynomial contrasts when you
don't want to use higher order polynomials.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">decompose_contrasts</span><span class="op">(</span></span>
<span>  <span class="va">model_data</span>,</span>
<span>  <span class="va">extract</span>,</span>
<span>  remove_intercept <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  remove_original <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-model-data">model_data<a class="anchor" aria-label="anchor" href="#arg-model-data"></a></dt>
<dd><p>Dataframe with factor columns</p></dd>


<dt id="arg-extract">extract<a class="anchor" aria-label="anchor" href="#arg-extract"></a></dt>
<dd><p>A one-sided formula denoting the factors to extract. Note this
should ideally be what you would pass to your model fitting function, sans
any non-factors.</p></dd>


<dt id="arg-remove-intercept">remove_intercept<a class="anchor" aria-label="anchor" href="#arg-remove-intercept"></a></dt>
<dd><p>Logical, whether to remove the column corresponding
to the intercept. Default <code>TRUE</code>  since it's always just a column of 1s</p></dd>


<dt id="arg-remove-original">remove_original<a class="anchor" aria-label="anchor" href="#arg-remove-original"></a></dt>
<dd><p>Logical, whether to remove the original columns in
the data frame after decomposing into separate columns. Default <code>FALSE</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>model_data</code> but with new columns corresponding to the numeric coding
of the given factor's contrasts</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>An additional usage for this function is to compute the contrasts for
interaction terms in a model. In <code>lm(y ~ A * B)</code>, where A and B are factors,
the expanded form is <code>lm(y ~ A + B + A:B)</code> with an equation of \(y =
\beta_Ax_A + \beta_Bx_B + \beta_{A:B}x_Ax_B\). The thing to note is that the
coefficient for the interaction(s) are multiplied by the product of \(x_A\)
and \(x_B\). Let's call this product \(x_C\). For example, if one value
of \(x_A\) is
-1/3 and one value of \(x_B\) is 2/3, then the product \(x_C\) is -2/9.
But, if there are 3 levels for \(x_A\) and 3 levels for \(x_B\), then we
get 4 columns for the fixed effects <em>and</em> 4 <em>more</em> columns for the
interaction terms. It can be a lot of tedious work to precompute the products
manually, so we can use this function with <code>extract_interaction = TRUE</code> to
compute everything at once.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="set_contrasts.html">set_contrasts()</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Decompose contrasts for carb and gear columns into new columns, using</span></span></span>
<span class="r-in"><span><span class="co"># the contrast labels used when setting the contrasts</span></span></span>
<span class="r-in"><span><span class="va">mtcars</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="set_contrasts.html">set_contrasts</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">carb</span> <span class="op">~</span> <span class="va">scaled_sum_code</span>,</span></span>
<span class="r-in"><span>    <span class="va">gear</span> <span class="op">~</span> <span class="va">contr.sum</span> <span class="op">|</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"4-mean"</span>, <span class="st">"5-mean"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu">decompose_contrasts</span><span class="op">(</span><span class="op">~</span> <span class="va">carb</span> <span class="op">+</span> <span class="va">gear</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Converting to factors: <span style="color: #0000BB;">carb gear</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 'data.frame':	32 obs. of  18 variables:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ mpg       : num  21 21 22.8 21.4 18.7 18.1 14.3 24.4 22.8 19.2 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ cyl       : num  6 6 4 6 8 6 8 4 4 6 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ disp      : num  160 160 108 258 360 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ hp        : num  110 110 93 110 175 105 245 62 95 123 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ drat      : num  3.9 3.9 3.85 3.08 3.15 2.76 3.21 3.69 3.92 3.92 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ wt        : num  2.62 2.88 2.32 3.21 3.44 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ qsec      : num  16.5 17 18.6 19.4 17 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ vs        : num  0 0 1 1 0 1 0 1 1 1 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ am        : num  1 1 1 0 0 0 0 0 0 0 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ gear      : Factor w/ 3 levels "3","4","5": 2 2 2 1 1 1 1 2 2 2 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..- attr(*, "contrasts")= num [1:3, 1:2] -1 1 0 -1 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..- attr(*, "dimnames")=List of 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..$ : chr [1:3] "3" "4" "5"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..$ : chr [1:2] "4-mean" "5-mean"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ carb      : Factor w/ 6 levels "1","2","3","4",..: 4 4 1 1 2 1 4 2 2 4 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..- attr(*, "contrasts")= num [1:6, 1:5] -0.167 0.833 -0.167 -0.167 -0.167 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..- attr(*, "dimnames")=List of 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..$ : chr [1:6] "1" "2" "3" "4" ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..$ : chr [1:5] "2" "3" "4" "6" ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ carb2     : num  -0.167 -0.167 -0.167 -0.167 0.833 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ carb3     : num  -0.167 -0.167 -0.167 -0.167 -0.167 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ carb4     : num  0.833 0.833 -0.167 -0.167 -0.167 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ carb6     : num  -0.167 -0.167 -0.167 -0.167 -0.167 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ carb8     : num  -0.167 -0.167 -0.167 -0.167 -0.167 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ gear4-mean: num  1 1 1 -1 -1 -1 -1 1 1 1 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ gear5-mean: num  0 0 0 -1 -1 -1 -1 0 0 0 ...</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Decompose an interaction term between the two factors</span></span></span>
<span class="r-in"><span><span class="va">mtcars</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="set_contrasts.html">set_contrasts</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">carb</span> <span class="op">~</span> <span class="va">scaled_sum_code</span>,</span></span>
<span class="r-in"><span>    <span class="va">gear</span> <span class="op">~</span> <span class="va">contr.sum</span> <span class="op">|</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"4-mean"</span>, <span class="st">"5-mean"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu">decompose_contrasts</span><span class="op">(</span><span class="op">~</span> <span class="va">carb</span> <span class="op">*</span> <span class="va">gear</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Converting to factors: <span style="color: #0000BB;">carb gear</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 'data.frame':	32 obs. of  28 variables:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ mpg             : num  21 21 22.8 21.4 18.7 18.1 14.3 24.4 22.8 19.2 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ cyl             : num  6 6 4 6 8 6 8 4 4 6 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ disp            : num  160 160 108 258 360 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ hp              : num  110 110 93 110 175 105 245 62 95 123 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ drat            : num  3.9 3.9 3.85 3.08 3.15 2.76 3.21 3.69 3.92 3.92 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ wt              : num  2.62 2.88 2.32 3.21 3.44 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ qsec            : num  16.5 17 18.6 19.4 17 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ vs              : num  0 0 1 1 0 1 0 1 1 1 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ am              : num  1 1 1 0 0 0 0 0 0 0 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ gear            : Factor w/ 3 levels "3","4","5": 2 2 2 1 1 1 1 2 2 2 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..- attr(*, "contrasts")= num [1:3, 1:2] -1 1 0 -1 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..- attr(*, "dimnames")=List of 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..$ : chr [1:3] "3" "4" "5"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..$ : chr [1:2] "4-mean" "5-mean"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ carb            : Factor w/ 6 levels "1","2","3","4",..: 4 4 1 1 2 1 4 2 2 4 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..- attr(*, "contrasts")= num [1:6, 1:5] -0.167 0.833 -0.167 -0.167 -0.167 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..- attr(*, "dimnames")=List of 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..$ : chr [1:6] "1" "2" "3" "4" ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..$ : chr [1:5] "2" "3" "4" "6" ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ carb2           : num  -0.167 -0.167 -0.167 -0.167 0.833 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ carb3           : num  -0.167 -0.167 -0.167 -0.167 -0.167 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ carb4           : num  0.833 0.833 -0.167 -0.167 -0.167 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ carb6           : num  -0.167 -0.167 -0.167 -0.167 -0.167 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ carb8           : num  -0.167 -0.167 -0.167 -0.167 -0.167 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ gear4-mean      : num  1 1 1 -1 -1 -1 -1 1 1 1 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ gear5-mean      : num  0 0 0 -1 -1 -1 -1 0 0 0 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ carb2:gear4-mean: num  -0.167 -0.167 -0.167 0.167 -0.833 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ carb3:gear4-mean: num  -0.167 -0.167 -0.167 0.167 0.167 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ carb4:gear4-mean: num  0.833 0.833 -0.167 0.167 0.167 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ carb6:gear4-mean: num  -0.167 -0.167 -0.167 0.167 0.167 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ carb8:gear4-mean: num  -0.167 -0.167 -0.167 0.167 0.167 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ carb2:gear5-mean: num  0 0 0 0.167 -0.833 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ carb3:gear5-mean: num  0 0 0 0.167 0.167 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ carb4:gear5-mean: num  0 0 0 0.167 0.167 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ carb6:gear5-mean: num  0 0 0 0.167 0.167 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ carb8:gear5-mean: num  0 0 0 0.167 0.167 ...</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Thomas Sostarics.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

