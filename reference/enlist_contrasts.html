<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Get a list of contrast matrices — enlist_contrasts • contrastable</title><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Get a list of contrast matrices — enlist_contrasts"><meta name="description" content="Returns a named list of contrast matrices to use with modeling
functions directly. See set_contrasts() for a function
to set contrasts directly to the dataframe. See details for syntax
information"><meta property="og:description" content="Returns a named list of contrast matrices to use with modeling
functions directly. See set_contrasts() for a function
to set contrasts directly to the dataframe. See details for syntax
information"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">contrastable</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.2.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/contrastable.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/contrasts.html">Contrastable Overview</a></li>
    <li><a class="dropdown-item" href="../articles/warnings.html">Warnings, Messages, and Errors</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/tsostarics/contrastable/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Get a list of contrast matrices</h1>
      <small class="dont-index">Source: <a href="https://github.com/tsostarics/contrastable/blob/main/R/enlist_contrasts.R" class="external-link"><code>R/enlist_contrasts.R</code></a></small>
      <div class="d-none name"><code>enlist_contrasts.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Returns a named list of contrast matrices to use with modeling
functions directly. See <code><a href="set_contrasts.html">set_contrasts()</a></code> for a function
to set contrasts directly to the dataframe. See details for syntax
information</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">enlist_contrasts</span><span class="op">(</span><span class="va">model_data</span>, <span class="va">...</span>, verbose <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"contrastable.verbose"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-model-data">model_data<a class="anchor" aria-label="anchor" href="#arg-model-data"></a></dt>
<dd><p>Data frame you intend on passing to your model</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>A series of 2 sided formulas with factor name on the left hand
side and desired contrast scheme on the right hand side. The reference
level can be set with <code>+</code>, the intercept can be overwritten with <code>*</code>,
comparison labels can be set using <code>|</code>, and trends for polynomial coding
can be removed using <code>-</code>.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Logical, defaults to FALSE, whether messages should be printed</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>List of named contrast matrices. Internally, if called within
set_contrasts, will return a named list with <code>contrasts</code> equal to the list
of named contrast matrices and <code>data</code> equal to the passed <code>model_data</code> with
any factor coercions applied (so that <code><a href="set_contrasts.html">set_contrasts()</a></code> doesn't need to do
it a second time).</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>enlist_contrasts()</code>, <code><a href="set_contrasts.html">set_contrasts()</a></code>,
and <code><a href="glimpse_contrasts.html">glimpse_contrasts()</a></code> use special syntax to set
contrasts for multiple factors. The syntax consists of two-sided formulas
with the desired factor column on the left hand side and the contrast
specification on the right hand side. For example, <code>varname ~ scaled_sum_code</code>. Many contrasts support additional kinds of contrast
manipulations using overloaded operators:</p><ul><li><p><code>+ X</code>: Set the reference level to the level named X. Only supported for
schemes that have a singular reference level such as
<code><a href="sum_code.html">sum_code()</a></code>, <code><a href="scaled_sum_code.html">scaled_sum_code()</a></code>,
<code><a href="treatment_code.html">treatment_code()</a></code>, <code><a href="https://rdrr.io/r/stats/contrast.html" class="external-link">stats::contr.treatment()</a></code>,
<code><a href="https://rdrr.io/r/stats/contrast.html" class="external-link">stats::contr.sum()</a></code>, <code><a href="https://rdrr.io/r/stats/contrast.html" class="external-link">stats::contr.SAS()</a></code>. Ignored for schemes like
<code><a href="helmert_code.html">helmert_code()</a></code>.</p></li>
<li><p><code>* X</code>: Overwrite the intercept to the mean of the level named X</p></li>
<li><p><code>- A:B</code>: For polynomial coding schemes only, drop comparisons A through B.</p></li>
<li><p><code>| c(...)</code>: Change the comparison labels for the contrast matrix to the
character vector <code>c(...)</code> of length <code>n-1</code>. These labels will appear in the
output/summary of a statistical model. Note that for <code>brms::brm</code>,
instances of <code>-</code> (a minus sign) are replaced with <code>M</code>.</p></li>
</ul><p>You can also specify multiple variables on the left hand side of a formula
using tidyselect helpers. See examples for more information.</p>
<p>Typically model functions like lm will have a contrasts argument where you
can set the contrasts at model run time, rather than having to manually
change the contrasts on the underlying factor columns in your data. This
function will return such a named list of contrast matrices to pass to these
functions. Note that this function should not be used within a modeling
function call, e.g., <code>lm(y~x, data = model_data, contrasts =
enlist_contrasts(model_data, x~sum_code))</code>. Often, this will call
<code>enlist_contrasts</code> twice, rather than just once.</p>
<p>For some model fitting functions, like <code>brms::brm</code>, there is no
contrasts argument. For such cases, use <code><a href="set_contrasts.html">set_contrasts()</a></code> to
set contrasts directly to the factors in a dataframe.</p>
<p>One good way to use <code>enlist_contrasts()</code> is in conjunction
with <code><a href="https://rdrr.io/pkg/MASS/man/fractions.html" class="external-link">MASS::fractions()</a></code> to create a list of matrices that can be printed
to explicitly show the entire contrast matrices you're using for your models.
This can be especially helpful for supplementary materials in an academic
paper.</p>
<p>Sometimes when using orthogonal polynomial contrasts from
<code><a href="https://rdrr.io/r/stats/contrast.html" class="external-link">stats::contr.poly()</a></code> people will drop higher level polynomials for
parsimony. Note however that these do capture some amount of variation, so
even though they're orthogonal contrasts the lower level polynomials will
have their estimates changed. Moreover, you cannot reduce a contrast matrix
to a matrix smaller than size n*n-1 in the dataframe you pass to a model
fitting function itself, as R will try to fill in the gaps with something
else. If you want to drop contrasts you'll need to use something like
<code>enlist_contrasts(df, x ~ contr.poly - 3:5)</code> and pass this to the
<code>contrasts</code> argument in the model fitting function.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="set_contrasts.html">set_contrasts()</a></code> <code><a href="glimpse_contrasts.html">glimpse_contrasts()</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">my_df</span> <span class="op">&lt;-</span> <span class="va">mtcars</span></span></span>
<span class="r-in"><span><span class="va">my_df</span><span class="op">$</span><span class="va">gear</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">my_df</span><span class="op">$</span><span class="va">gear</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">my_df</span><span class="op">$</span><span class="va">carb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">my_df</span><span class="op">$</span><span class="va">carb</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Use formulas where left hand side is the factor column name</span></span></span>
<span class="r-in"><span><span class="co"># and the right hand side is the contrast scheme you want to use</span></span></span>
<span class="r-in"><span><span class="fu">enlist_contrasts</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">my_df</span>,</span></span>
<span class="r-in"><span>  <span class="va">gear</span> <span class="op">~</span> <span class="va">scaled_sum_code</span>,</span></span>
<span class="r-in"><span>  <span class="va">carb</span> <span class="op">~</span> <span class="va">helmert_code</span>,</span></span>
<span class="r-in"><span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $gear</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            4          5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 -0.3333333 -0.3333333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  0.6666667 -0.3333333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 -0.3333333  0.6666667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $carb</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     &lt;2         &lt;3    &lt;4   &lt;6         &lt;8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 -0.5 -0.3333333 -0.25 -0.2 -0.1666667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  0.5 -0.3333333 -0.25 -0.2 -0.1666667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  0.0  0.6666667 -0.25 -0.2 -0.1666667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  0.0  0.0000000  0.75 -0.2 -0.1666667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  0.0  0.0000000  0.00  0.8 -0.1666667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  0.0  0.0000000  0.00  0.0  0.8333333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Add reference levels with +</span></span></span>
<span class="r-in"><span><span class="fu">enlist_contrasts</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">my_df</span>,</span></span>
<span class="r-in"><span>  <span class="va">gear</span> <span class="op">~</span> <span class="va">scaled_sum_code</span> <span class="op">+</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>  <span class="va">carb</span> <span class="op">~</span> <span class="va">contr.sum</span> <span class="op">+</span> <span class="fl">6</span>,</span></span>
<span class="r-in"><span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $gear</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            3          4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  0.6666667 -0.3333333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 -0.3333333  0.6666667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 -0.3333333 -0.3333333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $carb</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    1  2  3  4  8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  1  0  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  0  1  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  0  0  1  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  0  0  0  1  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 -1 -1 -1 -1 -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  0  0  0  0  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># Manually specifying matrix also works</span></span></span>
<span class="r-in"><span><span class="fu">enlist_contrasts</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">my_df</span>,</span></span>
<span class="r-in"><span>  <span class="va">gear</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="va">carb</span> <span class="op">~</span> <span class="va">forward_difference_code</span>,</span></span>
<span class="r-in"><span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $gear</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    4  5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 -1 -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  1  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  0  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $carb</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          1-2        2-3  3-4        4-6        6-8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  0.8333333  0.6666667  0.5  0.3333333  0.1666667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 -0.1666667  0.6666667  0.5  0.3333333  0.1666667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 -0.1666667 -0.3333333  0.5  0.3333333  0.1666667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 -0.1666667 -0.3333333 -0.5  0.3333333  0.1666667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 -0.1666667 -0.3333333 -0.5 -0.6666667  0.1666667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8 -0.1666667 -0.3333333 -0.5 -0.6666667 -0.8333333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># User matrices can be assigned to a variable first, but this may make the</span></span></span>
<span class="r-in"><span><span class="co"># comparison labels confusing. You should rename them manually to something</span></span></span>
<span class="r-in"><span><span class="co"># that makes sense. This will invoke use_contrast_matrix, so reference levels</span></span></span>
<span class="r-in"><span><span class="co"># specified with + will be ignored.</span></span></span>
<span class="r-in"><span><span class="va">my_gear_contrasts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">my_gear_contrasts</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CMP1"</span>, <span class="st">"CMP2"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">enlist_contrasts</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">my_df</span>,</span></span>
<span class="r-in"><span>  <span class="va">gear</span> <span class="op">~</span> <span class="va">my_gear_contrasts</span>,</span></span>
<span class="r-in"><span>  <span class="va">carb</span> <span class="op">~</span> <span class="va">forward_difference_code</span>,</span></span>
<span class="r-in"><span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $gear</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    4  5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 -1 -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  1  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  0  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $carb</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          1-2        2-3  3-4        4-6        6-8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  0.8333333  0.6666667  0.5  0.3333333  0.1666667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 -0.1666667  0.6666667  0.5  0.3333333  0.1666667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 -0.1666667 -0.3333333  0.5  0.3333333  0.1666667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 -0.1666667 -0.3333333 -0.5  0.3333333  0.1666667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 -0.1666667 -0.3333333 -0.5 -0.6666667  0.1666667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8 -0.1666667 -0.3333333 -0.5 -0.6666667 -0.8333333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Will inform you if there are factors you didn't set</span></span></span>
<span class="r-in"><span><span class="fu">enlist_contrasts</span><span class="op">(</span><span class="va">my_df</span>, <span class="va">gear</span> <span class="op">~</span> <span class="va">scaled_sum_code</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Expect <span style="color: #0000BB;">contr.treatment</span> or <span style="color: #BB0000;">contr.poly</span> for unset factors: <span style="color: #0000BB;">carb</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $gear</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            4          5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 -0.3333333 -0.3333333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  0.6666667 -0.3333333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 -0.3333333  0.6666667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Use MASS::fractions to pretty print matrices for academic papers:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu">enlist_contrasts</span><span class="op">(</span><span class="va">my_df</span>, <span class="va">gear</span> <span class="op">~</span> <span class="va">scaled_sum_code</span>, <span class="va">carb</span> <span class="op">~</span> <span class="va">helmert_code</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>       <span class="fu">MASS</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/MASS/man/fractions.html" class="external-link">fractions</a></span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $gear</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4    5   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 -1/3 -1/3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  2/3 -1/3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 -1/3  2/3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $carb</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   &lt;2   &lt;3   &lt;4   &lt;6   &lt;8  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 -1/2 -1/3 -1/4 -1/5 -1/6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  1/2 -1/3 -1/4 -1/5 -1/6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    0  2/3 -1/4 -1/5 -1/6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    0    0  3/4 -1/5 -1/6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6    0    0    0  4/5 -1/6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8    0    0    0    0  5/6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Use a list of formulas to use the same contrasts with different datasets</span></span></span>
<span class="r-in"><span><span class="va">my_contrasts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">gear</span> <span class="op">~</span> <span class="va">scaled_sum_code</span>, <span class="va">carb</span> <span class="op">~</span> <span class="va">helmert_code</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">enlist_contrasts</span><span class="op">(</span><span class="va">my_df</span>,  <span class="va">my_contrasts</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $gear</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            4          5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 -0.3333333 -0.3333333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  0.6666667 -0.3333333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 -0.3333333  0.6666667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $carb</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     &lt;2         &lt;3    &lt;4   &lt;6         &lt;8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 -0.5 -0.3333333 -0.25 -0.2 -0.1666667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  0.5 -0.3333333 -0.25 -0.2 -0.1666667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  0.0  0.6666667 -0.25 -0.2 -0.1666667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  0.0  0.0000000  0.75 -0.2 -0.1666667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  0.0  0.0000000  0.00  0.8 -0.1666667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  0.0  0.0000000  0.00  0.0  0.8333333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu">enlist_contrasts</span><span class="op">(</span><span class="va">mtcars</span>, <span class="va">my_contrasts</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Converting to factors: <span style="color: #0000BB;">gear carb</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $gear</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            4          5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 -0.3333333 -0.3333333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  0.6666667 -0.3333333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 -0.3333333  0.6666667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $carb</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     &lt;2         &lt;3    &lt;4   &lt;6         &lt;8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 -0.5 -0.3333333 -0.25 -0.2 -0.1666667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  0.5 -0.3333333 -0.25 -0.2 -0.1666667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  0.0  0.6666667 -0.25 -0.2 -0.1666667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  0.0  0.0000000  0.75 -0.2 -0.1666667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  0.0  0.0000000  0.00  0.8 -0.1666667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  0.0  0.0000000  0.00  0.0  0.8333333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Use tidyselect helpers to set multiple variables at once</span></span></span>
<span class="r-in"><span><span class="co"># These are all equivalent</span></span></span>
<span class="r-in"><span><span class="va">contr_list1</span> <span class="op">&lt;-</span> <span class="fu">enlist_contrasts</span><span class="op">(</span><span class="va">mtcars</span>,</span></span>
<span class="r-in"><span>                 <span class="va">cyl</span> <span class="op">~</span> <span class="va">sum_code</span>, <span class="va">gear</span> <span class="op">~</span> <span class="va">sum_code</span>,</span></span>
<span class="r-in"><span>                 verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">contr_list2</span> <span class="op">&lt;-</span> <span class="fu">enlist_contrasts</span><span class="op">(</span><span class="va">mtcars</span>,</span></span>
<span class="r-in"><span>                 <span class="va">cyl</span> <span class="op">+</span> <span class="va">gear</span> <span class="op">~</span> <span class="va">sum_code</span>,</span></span>
<span class="r-in"><span>                 verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">contr_list3</span> <span class="op">&lt;-</span> <span class="fu">enlist_contrasts</span><span class="op">(</span><span class="va">mtcars</span>,</span></span>
<span class="r-in"><span>                 <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">cyl</span>, <span class="va">gear</span><span class="op">)</span> <span class="op">~</span> <span class="va">sum_code</span>,</span></span>
<span class="r-in"><span>                 verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">contr_list4</span> <span class="op">&lt;-</span> <span class="fu">enlist_contrasts</span><span class="op">(</span><span class="va">mtcars</span>,</span></span>
<span class="r-in"><span>                 <span class="fu">all_of</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'cyl'</span>, <span class="st">'gear'</span><span class="op">)</span><span class="op">)</span> <span class="op">~</span> <span class="va">sum_code</span>,</span></span>
<span class="r-in"><span>                 verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">these_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cyl"</span>, <span class="st">"gear"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">contr_list5</span> <span class="op">&lt;-</span> <span class="fu">enlist_contrasts</span><span class="op">(</span><span class="va">mtcars</span>,</span></span>
<span class="r-in"><span>                                <span class="fu">all_of</span><span class="op">(</span><span class="va">these_vars</span><span class="op">)</span> <span class="op">~</span> <span class="va">sum_code</span>,</span></span>
<span class="r-in"><span>                                verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">contr_list1</span>, <span class="va">contr_list2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">contr_list2</span>, <span class="va">contr_list3</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">contr_list3</span>, <span class="va">contr_list4</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">contr_list4</span>, <span class="va">contr_list5</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># You can also use [tidyselect::where()] with class checking helpers:</span></span></span>
<span class="r-in"><span><span class="va">contr_list6</span> <span class="op">&lt;-</span> <span class="fu">enlist_contrasts</span><span class="op">(</span><span class="va">mtcars</span>,</span></span>
<span class="r-in"><span>                                <span class="fu">where</span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span> <span class="op">~</span> <span class="va">sum_code</span>,</span></span>
<span class="r-in"><span>                                verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Each variable name must only be set ONCE, e.g. these will fail:</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu">enlist_contrasts</span><span class="op">(</span><span class="va">mtcars</span>,</span></span>
<span class="r-in"><span>                     <span class="va">cyl</span> <span class="op">~</span> <span class="va">sum_code</span>,</span></span>
<span class="r-in"><span>                     <span class="va">cyl</span> <span class="op">~</span> <span class="va">scaled_sum_code</span>,</span></span>
<span class="r-in"><span>                     verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Error : In `pkgdown::build_site_github_pages(new_process = FALSE, install = ...`: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Names must be unique.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BB0000;">✖</span> These names are duplicated:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   * "cyl" at locations 1 and 2.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Left hand side of multiple formulas evaluated to the same column name</span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu">enlist_contrasts</span><span class="op">(</span><span class="va">mtcars</span>,</span></span>
<span class="r-in"><span>                     <span class="va">cyl</span> <span class="op">~</span> <span class="va">sum_code</span>,</span></span>
<span class="r-in"><span>                     <span class="fu">all_of</span><span class="op">(</span><span class="va">these_vars</span><span class="op">)</span> <span class="op">~</span> <span class="va">scaled_sum_code</span>,</span></span>
<span class="r-in"><span>                     verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Error : In `pkgdown::build_site_github_pages(new_process = FALSE, install = ...`: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Names must be unique.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BB0000;">✖</span> These names are duplicated:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   * "cyl" at locations 1 and 2.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Left hand side of multiple formulas evaluated to the same column name</span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu">enlist_contrasts</span><span class="op">(</span><span class="va">mtcars</span>,</span></span>
<span class="r-in"><span>                     <span class="va">cyl</span> <span class="op">~</span> <span class="va">sum_code</span>,</span></span>
<span class="r-in"><span>                     <span class="fu">where</span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span> <span class="op">~</span> <span class="va">scaled_sum_code</span>,</span></span>
<span class="r-in"><span>                     verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Error : In `pkgdown::build_site_github_pages(new_process = FALSE, install = ...`: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Names must be unique.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BB0000;">✖</span> These names are duplicated:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   * "cyl" at locations 1 and 3.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Left hand side of multiple formulas evaluated to the same column name</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Thomas Sostarics.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

