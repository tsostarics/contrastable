<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Warnings, Messages, and Errors • contrastable</title>
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Warnings, Messages, and Errors">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">contrastable</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.2.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/contrastable.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/contrasts.html">Contrastable Overview</a></li>
    <li><a class="dropdown-item" href="../articles/warnings.html">Warnings, Messages, and Errors</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/tsostarics/contrastable/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Warnings, Messages, and Errors</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/tsostarics/contrastable/blob/main/vignettes/warnings.Rmd" class="external-link"><code>vignettes/warnings.Rmd</code></a></small>
      <div class="d-none name"><code>warnings.Rmd</code></div>
    </div>

    
    
<p>This vignette provides documentation for the different warnings and
messages that are implemented for the package. Results of calls (eg
printing of data frames following <code>set_contrasts</code>) will be
hidden, but warnings and messages will still be shown. Code chunks will
be self-contained, so bear with a little repetitiveness. I will
primarily be using the <code>sum_code</code> function because it is the
shortest one to write.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tsostarics/contrastable" class="external-link">contrastable</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rlang.r-lib.org" class="external-link">rlang</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="common-messages">Common Messages<a class="anchor" aria-label="anchor" href="#common-messages"></a>
</h2>
<p>User will be notified if a non-factor column is coerced to a factor
with <code>set_contrasts</code> and <code>enlist_contrasts</code>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/set_contrasts.html">set_contrasts</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="va">cyl</span> <span class="op">~</span> <span class="va">sum_code</span><span class="op">)</span></span>
<span><span class="co">#&gt; Converting to factors: <span style="color: #0000BB;">cyl</span></span></span></code></pre></div>
<p>User will be notified if there exist other factors in the dataframe
that have not been set in a call to <code>set_contrasts</code> or
<code>enlist_contrasts</code>. Unordered factors are color coded in
blue, while ordered factors are colored red. The default contrasts from
<code>options("contrasts")</code> are also displayed and color coded
accordingly.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_data</span> <span class="op">&lt;-</span> <span class="va">mtcars</span></span>
<span><span class="va">my_data</span><span class="op">$</span><span class="va">gear</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">ordered</a></span><span class="op">(</span><span class="va">my_data</span><span class="op">$</span><span class="va">gear</span><span class="op">)</span></span>
<span><span class="va">my_data</span><span class="op">$</span><span class="va">carb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">my_data</span><span class="op">$</span><span class="va">carb</span><span class="op">)</span></span>
<span><span class="va">my_data</span><span class="op">$</span><span class="va">cyl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">my_data</span><span class="op">$</span><span class="va">cyl</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/set_contrasts.html">set_contrasts</a></span><span class="op">(</span><span class="va">my_data</span>, <span class="va">cyl</span> <span class="op">~</span> <span class="va">sum_code</span><span class="op">)</span></span>
<span><span class="co">#&gt; Expect <span style="color: #0000BB;">contr.treatment</span> or <span style="color: #BB0000;">contr.poly</span> for unset factors: <span style="color: #BB0000;">gear</span> <span style="color: #0000BB;">carb</span></span></span></code></pre></div>
<p>Ordered factors by default use <code>contr.poly</code> and return
coefficient estimates interpretable as nth-degree polynomial trends.
Typically, contrast matrices are set for unordered factors, so ordered
factors are a bit of a special case. So, user will be notified if
setting the contrasts for an ordered factor with
<code>set_contrasts</code> or <code>enlist_contrasts</code></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_data</span> <span class="op">&lt;-</span> <span class="va">mtcars</span></span>
<span><span class="va">my_data</span><span class="op">$</span><span class="va">gear</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">ordered</a></span><span class="op">(</span><span class="va">my_data</span><span class="op">$</span><span class="va">gear</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/set_contrasts.html">set_contrasts</a></span><span class="op">(</span><span class="va">my_data</span>, <span class="va">gear</span> <span class="op">~</span> <span class="va">sum_code</span><span class="op">)</span></span>
<span><span class="co">#&gt; These factors are ordered, you may lose <span style="color: #BB0000;">contr.poly</span>: <span style="color: #BB0000;">gear</span></span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="warnings">Warnings<a class="anchor" aria-label="anchor" href="#warnings"></a>
</h2>
<p>User will be warned if attempting to set contrasts on a factor with
only one level. If the user sets contrasts for multiple variables, any
variables with more than one level will successfully be computed.
However, the variables with only one level will just show no results.
Note the output in the example below.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>foo <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="st">"A"</span><span class="op">)</span>,</span>
<span>                      boo <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"B"</span>, <span class="st">"C"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/enlist_contrasts.html">enlist_contrasts</a></span><span class="op">(</span><span class="va">my_data</span>, <span class="va">foo</span> <span class="op">~</span> <span class="va">sum_code</span>, <span class="va">boo</span> <span class="op">~</span> <span class="va">sum_code</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Contrasts undefined for factors with only one level: <span style="color: #00BBBB;">foo</span></span></span>
<span><span class="co">#&gt; $boo</span></span>
<span><span class="co">#&gt;    C</span></span>
<span><span class="co">#&gt; B -1</span></span>
<span><span class="co">#&gt; C  1</span></span></code></pre></div>
<p>Related to the above, if the user only sets contrasts on factors that
have only one level, an error will be thrown. The above warning will
also be shown.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>foo <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="st">"A"</span><span class="op">)</span>,</span>
<span>                      boo <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"B"</span>, <span class="st">"C"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu"><a href="../reference/enlist_contrasts.html">enlist_contrasts</a></span><span class="op">(</span><span class="va">my_data</span>, <span class="va">foo</span> <span class="op">~</span> <span class="va">sum_code</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Expect <span style="color: #0000BB;">contr.treatment</span> or <span style="color: #BB0000;">contr.poly</span> for unset factors: <span style="color: #0000BB;">boo</span></span></span>
<span><span class="co">#&gt; Warning: Contrasts undefined for factors with only one level: <span style="color: #00BBBB;">foo</span></span></span>
<span><span class="co">#&gt; Error in enlist_contrasts(my_data, foo ~ sum_code) : </span></span>
<span><span class="co">#&gt;   No factors with more than 1 level found</span></span></code></pre></div>
<p>Contrastable provides some flexibility in how contrasts are passed to
formulas. Under the hood, methods are defined for the following object
classes:</p>
<ul>
<li>matrix</li>
<li>symbol/name</li>
<li>function</li>
<li>hypr</li>
</ul>
<p>You’ll receive a warning if you use something else and the default
contrast (depending on ordered or unordered) will be used instead.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sum_code.html">sum_code</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>  <span class="co"># current class is "matrix" "array"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">my_matrix</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"foo"</span> <span class="co"># now class is "foo"</span></span>
<span></span>
<span><span class="fu"><a href="../reference/set_contrasts.html">set_contrasts</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="va">cyl</span> <span class="op">~</span> <span class="va">my_matrix</span><span class="op">)</span> <span class="op">|&gt;</span>  <span class="co"># idk what to do with "foo" objects</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Converting to factors: <span style="color: #0000BB;">cyl</span></span></span>
<span><span class="co">#&gt; Warning in use_contrasts.default(factor_col = get(params[["factor_col"]], :</span></span>
<span><span class="co">#&gt; Can't set contrasts with object of class foo. Using unordered default</span></span>
<span><span class="co">#&gt; <span style="color: #0000BB;">contr.treatment</span></span></span></code></pre></div>
<p>So long as the object <em>inherits</em> one of the above classes
though it will work as expected. Accordingly, note that no class
coercion happens here.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">my_matrix</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"foo"</span>, <span class="st">"matrix"</span>, <span class="st">"array"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/set_contrasts.html">set_contrasts</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="va">cyl</span> <span class="op">~</span> <span class="va">my_matrix</span><span class="op">)</span> <span class="co"># idk what "foo" is but i know "matrix"!</span></span>
<span><span class="co">#&gt; Converting to factors: <span style="color: #0000BB;">cyl</span></span></span></code></pre></div>
<p>Note that if you accidentally quote the function name, you will
receive an error instead because it thinks you’re trying to set
contrasts with an atomic character object.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu"><a href="../reference/set_contrasts.html">set_contrasts</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="va">cyl</span> <span class="op">~</span> <span class="st">"sum_code"</span><span class="op">)</span><span class="op">)</span> <span class="co"># sum_code shouldnt be in quotes</span></span>
<span><span class="co">#&gt; Converting to factors: <span style="color: #0000BB;">cyl</span></span></span>
<span><span class="co">#&gt; Error in use_contrasts.default(factor_col = get(params[["factor_col"]],  : </span></span>
<span><span class="co">#&gt;   Can't set contrasts with atomic type object, see example below:</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> var ~ 1 + sum_code</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> var ~ sum_code + 1</span></span></code></pre></div>
<p>The same issue can commonly occur if you don’t order the right hand
side correctly. The first term should always be a contrast-generating
function or a variable name that’s been assigned an object of the above
classes. Failure to do this can lead to other kinds of errors depending
on what the first element to the right hand side is. I’ve tried to
document a few cases of illformedness, but I can’t do every case.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu"><a href="../reference/set_contrasts.html">set_contrasts</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="va">cyl</span> <span class="op">~</span> <span class="fl">4</span> <span class="op">+</span> <span class="va">sum_code</span><span class="op">)</span><span class="op">)</span>    <span class="co"># bad!</span></span>
<span><span class="co">#&gt; Converting to factors: <span style="color: #0000BB;">cyl</span></span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu"><a href="../reference/set_contrasts.html">set_contrasts</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="va">cyl</span> <span class="op">~</span> <span class="va">sum_code</span> <span class="op">+</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="co"># good!</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Converting to factors: <span style="color: #0000BB;">cyl</span></span></span>
<span></span>
<span><span class="co"># These give different kinds of errors, all are ill-formed</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu"><a href="../reference/set_contrasts.html">set_contrasts</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="va">cyl</span> <span class="op">~</span> <span class="op">+</span><span class="fl">4</span> <span class="op">+</span> <span class="va">sum_code</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="co">#&gt; Converting to factors: <span style="color: #0000BB;">cyl</span></span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu"><a href="../reference/set_contrasts.html">set_contrasts</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="va">cyl</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span><span class="op">)</span> <span class="op">+</span> <span class="va">sum_code</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="co">#&gt; Converting to factors: <span style="color: #0000BB;">cyl</span></span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu"><a href="../reference/set_contrasts.html">set_contrasts</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="va">cyl</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="fl">2</span> <span class="op">+</span> <span class="fl">3</span> <span class="op">+</span> <span class="va">sum_code</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="co">#&gt; Converting to factors: <span style="color: #0000BB;">cyl</span></span></span>
<span><span class="co">#&gt; Warning in is.na(params[[which_param]]): is.na() applied to non-(list or</span></span>
<span><span class="co">#&gt; vector) of type 'symbol'</span></span></code></pre></div>
<div class="section level3">
<h3 id="hypr-integration">hypr integration<a class="anchor" aria-label="anchor" href="#hypr-integration"></a>
</h3>
<p>hypr is another package for contrast coding but focuses on setting
the desired comparisons for a factor manually. The philosophy there is
that <em>all</em> comparisons should be explicitly written down, while
the philosophy with this package is that well-defined contrast schemes
should be implemented in a way that is deterministic and not prone to
typing errors. Accordingly, the special syntax this package provides is
ignored when using hypr objects.</p>
<p>Note that the examples here are set to not be run so that you’re not
forced to have the hypr package installed in order to install the
package/build the vignette.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://maxrabe.com/hypr" class="external-link">hypr</a></span><span class="op">)</span></span>
<span><span class="va">my_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>foo <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">hypr_object</span> <span class="op">&lt;-</span> <span class="fu">hypr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/hypr/man/hypr.html" class="external-link">hypr</a></span><span class="op">(</span><span class="va">A</span> <span class="op">~</span> <span class="va">B</span>, <span class="va">A</span> <span class="op">~</span> <span class="va">C</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/set_contrasts.html">set_contrasts</a></span><span class="op">(</span><span class="va">my_data</span>, <span class="va">foo</span> <span class="op">~</span> <span class="va">hypr_object</span> <span class="op">+</span> <span class="st">"B"</span> <span class="op">*</span> <span class="st">"B"</span> <span class="op">-</span> <span class="st">"C"</span><span class="op">)</span></span></code></pre></div>
<pre><code>Warning messages:
1: In use_contrasts.hypr(factor_col = get(params[["factor_col"]], model_data),  :
reference_level ignored when using hypr object
2: In use_contrasts.hypr(factor_col = get(params[["factor_col"]], model_data),  :
set_intercept ignored when using hypr object
3: In use_contrasts.hypr(factor_col = get(params[["factor_col"]], model_data),  :
drop_trends ignored when using hypr object</code></pre>
<p>hypr objects don’t need access to the levels in a factor, so there’s
an opportunity for mismatches in level names to arise. The matrix might
still work out to be what you intend, but this isn’t guaranteed.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>foo <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">hypr_object</span> <span class="op">&lt;-</span> <span class="fu">hypr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/hypr/man/hypr.html" class="external-link">hypr</a></span><span class="op">(</span><span class="va">varA</span> <span class="op">~</span> <span class="va">varB</span>, <span class="va">varA</span> <span class="op">~</span> <span class="va">varC</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/set_contrasts.html">set_contrasts</a></span><span class="op">(</span><span class="va">my_data</span>, <span class="va">foo</span> <span class="op">~</span> <span class="va">hypr_object</span><span class="op">)</span><span class="op">$</span><span class="va">foo</span></span></code></pre></div>
<pre><code>Warning message:
In use_contrasts.hypr(factor_col = get(params[["factor_col"]], model_data),  :
Levels in hypr object not found in factor column `foo`: varA, varB, varC
Contrasts may be misspecified.</code></pre>
<p>Generally, this package isn’t really designed with the hypr-user in
mind. But, so long as you’re mindful of the level names and the number
of levels, then you can plug in hypr objects freely in conjunction with
other methods. This is helpful if you need to use a custom matrix for
just one variable, but the rest can use “standard” contrasts.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>foo <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                      boo <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">hypr_object</span> <span class="op">&lt;-</span> <span class="fu">hypr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/hypr/man/hypr.html" class="external-link">hypr</a></span><span class="op">(</span><span class="va">A</span> <span class="op">~</span> <span class="va">B</span>, <span class="va">A</span> <span class="op">~</span> <span class="va">C</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/enlist_contrasts.html">enlist_contrasts</a></span><span class="op">(</span><span class="va">my_data</span>, <span class="va">foo</span> <span class="op">~</span> <span class="va">hypr_object</span>, <span class="va">boo</span> <span class="op">~</span> <span class="va">sum_code</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="glimpse_contrasts-safety-checks">glimpse_contrasts safety checks<a class="anchor" aria-label="anchor" href="#glimpse_contrasts-safety-checks"></a>
</h3>
<p><code>glimpse_contrasts</code> has a fairly extensive set of
warnings, so I’m giving it its own subsection. Broadly, these warnings
relate to mismatches between what the user defines in a series of
formulas and what is actually set on the provided dataframe. Special to
these warnings is that they will provide written out R code that the
user can copy and paste from the console to fix the issue— where “fix”
refers to “setting the contrasts to the dataframe explicitly with
<code>set_contrasts</code>”.</p>
<p>User will be warned if the contrast matrix for a factor in a
dataframe does not match the contrasts defined by the provided
formulas.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>foo <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="st">"A"</span><span class="op">)</span>,</span>
<span>                      boo <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"B"</span>, <span class="st">"C"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/glimpse_contrasts.html">glimpse_contrasts</a></span><span class="op">(</span><span class="va">my_data</span>, <span class="va">boo</span> <span class="op">~</span> <span class="va">sum_code</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Contrasts for these factors in `my_data` don't match formulas:</span></span>
<span><span class="co">#&gt;  - boo</span></span>
<span><span class="co">#&gt; To fix, be sure to run:</span></span>
<span><span class="co">#&gt; my_data &lt;- set_contrasts(my_data, </span></span>
<span><span class="co">#&gt;                          boo ~ sum_code)</span></span>
<span><span class="co">#&gt;   factor n level_names   scheme reference  intercept</span></span>
<span><span class="co">#&gt; 1    boo 2        B, C sum_code      &lt;NA&gt; grand mean</span></span></code></pre></div>
<p>Note that you can also define the contrast formulas in a list, and
this will be reflected in the warning as well.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>foo <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="st">"A"</span><span class="op">)</span>,</span>
<span>                      boo <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"B"</span>, <span class="st">"C"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define our contrasts outside the call</span></span>
<span><span class="va">clist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">boo</span> <span class="op">~</span> <span class="va">sum_code</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/glimpse_contrasts.html">glimpse_contrasts</a></span><span class="op">(</span><span class="va">my_data</span>, <span class="va">clist</span><span class="op">)</span> <span class="co"># Note the final line in the warning</span></span>
<span><span class="co">#&gt; Warning: Contrasts for these factors in `my_data` don't match formulas:</span></span>
<span><span class="co">#&gt;  - boo</span></span>
<span><span class="co">#&gt; To fix, be sure to run:</span></span>
<span><span class="co">#&gt; my_data &lt;- set_contrasts(my_data, clist)</span></span>
<span><span class="co">#&gt;   factor n level_names   scheme reference  intercept</span></span>
<span><span class="co">#&gt; 1    boo 2        B, C sum_code      &lt;NA&gt; grand mean</span></span></code></pre></div>
<p>Using some of the contrast-generating matrix functions in this
package <em>with</em> <code>set_contrasts</code> or
<code>enlist_contrasts</code> will automatically set the comparison
labels (i.e., the column names of the contrast matrix). However, using
these functions on their own will not specify the labels (because they
merely return matrices given some arbitrary number of levels). So, if
you manually set the contrasts to a factor without also defining the
comparison labels, then the labels will be missing. When using the same
contrast generating function in <code>glimpse_contrast</code>, the user
will be warned that the <em>comparison labels don’t match</em> (even
though the <em>contrast matrices</em> do).</p>
<p>Here’s an example when the labels are missing:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_data</span> <span class="op">&lt;-</span> <span class="va">mtcars</span></span>
<span><span class="va">my_data</span><span class="op">$</span><span class="va">cyl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">my_data</span><span class="op">$</span><span class="va">cyl</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># This will erase the column names</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/contrasts.html" class="external-link">contrasts</a></span><span class="op">(</span><span class="va">my_data</span><span class="op">$</span><span class="va">cyl</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/helmert_code.html">helmert_code</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/glimpse_contrasts.html">glimpse_contrasts</a></span><span class="op">(</span><span class="va">my_data</span>, <span class="va">cyl</span> <span class="op">~</span> <span class="va">helmert_code</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Comparison labels for contrasts in `my_data` don't match:</span></span>
<span><span class="co">#&gt;  - cyl   (expected `&lt;6, &lt;8` but found ``)</span></span>
<span><span class="co">#&gt; To fix, be sure to run:</span></span>
<span><span class="co">#&gt; my_data &lt;- set_contrasts(my_data, </span></span>
<span><span class="co">#&gt;                          cyl ~ helmert_code)</span></span>
<span><span class="co">#&gt;   factor n level_names       scheme reference  intercept</span></span>
<span><span class="co">#&gt; 1    cyl 3     4, 6, 8 helmert_code      &lt;NA&gt; grand mean</span></span></code></pre></div>
<p>And here’s an example when they exist but don’t match</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_data</span> <span class="op">&lt;-</span> <span class="va">mtcars</span></span>
<span><span class="va">my_data</span><span class="op">$</span><span class="va">cyl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">my_data</span><span class="op">$</span><span class="va">cyl</span><span class="op">)</span> <span class="co"># contr.treatment by default</span></span>
<span></span>
<span><span class="fu"><a href="../reference/glimpse_contrasts.html">glimpse_contrasts</a></span><span class="op">(</span><span class="va">my_data</span>, <span class="va">cyl</span> <span class="op">~</span> <span class="va">treatment_code</span> <span class="op">|</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"6vs4"</span>, <span class="st">"8vs4"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Comparison labels for contrasts in `my_data` don't match:</span></span>
<span><span class="co">#&gt;  - cyl   (expected `6vs4, 8vs4` but found `6, 8`)</span></span>
<span><span class="co">#&gt; To fix, be sure to run:</span></span>
<span><span class="co">#&gt; my_data &lt;- set_contrasts(my_data, </span></span>
<span><span class="co">#&gt;                          cyl ~ treatment_code | c("6vs4", "8vs4"))</span></span></code></pre></div>
<p>The user will be warned when specifying contrasts with
<code>glimpse_contrasts</code> for a variable that isn’t a factor. So,
<code>set_contrasts</code> will coerce the variable to a factor, but
<code>glimpse_contrasts</code> doesn’t modify the dataframe it’s
given.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_data</span> <span class="op">&lt;-</span> <span class="va">mtcars</span></span>
<span></span>
<span><span class="fu"><a href="../reference/glimpse_contrasts.html">glimpse_contrasts</a></span><span class="op">(</span><span class="va">my_data</span>, <span class="va">cyl</span> <span class="op">~</span> <span class="va">sum_code</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: These vars in `my_data` are not factors:</span></span>
<span><span class="co">#&gt;  - cyl</span></span>
<span><span class="co">#&gt; To fix, be sure to run:</span></span>
<span><span class="co">#&gt; my_data &lt;- set_contrasts(my_data, </span></span>
<span><span class="co">#&gt;                          cyl ~ sum_code)</span></span>
<span><span class="co">#&gt;   factor n level_names   scheme reference  intercept</span></span>
<span><span class="co">#&gt; 1    cyl 3     4, 6, 8 sum_code      &lt;NA&gt; grand mean</span></span></code></pre></div>
<p>ALL of the above described warnings can occur at the same time. They
are combined into a single warning. Note that when warned about the
<em>comparison labels</em> not matching, the numeric matrices are
nonetheless the same. Typically, when the matrices are different, the
labels will <em>also</em> be different, so the latter isn’t reported
when the matrices differ to save space.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_data</span> <span class="op">&lt;-</span> <span class="va">mtcars</span></span>
<span><span class="va">my_data</span><span class="op">$</span><span class="va">cyl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">my_data</span><span class="op">$</span><span class="va">cyl</span><span class="op">)</span> <span class="co"># contr.treatment by default</span></span>
<span><span class="va">my_data</span><span class="op">$</span><span class="va">carb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">my_data</span><span class="op">$</span><span class="va">carb</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/contrasts.html" class="external-link">contrasts</a></span><span class="op">(</span><span class="va">my_data</span><span class="op">$</span><span class="va">cyl</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sum_code.html">sum_code</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">my_data</span><span class="op">$</span><span class="va">am</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">my_data</span><span class="op">$</span><span class="va">am</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/glimpse_contrasts.html">glimpse_contrasts</a></span><span class="op">(</span><span class="va">my_data</span>, </span>
<span>                  <span class="va">cyl</span> <span class="op">~</span> <span class="va">sum_code</span>, </span>
<span>                  <span class="va">carb</span> <span class="op">~</span> <span class="va">sum_code</span>, </span>
<span>                  <span class="va">gear</span> <span class="op">~</span> <span class="va">sum_code</span>,</span>
<span>                  <span class="va">am</span> <span class="op">~</span> <span class="va">treatment_code</span> <span class="op">|</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"diffLabel"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: These vars in `my_data` are not factors:</span></span>
<span><span class="co">#&gt;  - gear</span></span>
<span><span class="co">#&gt; Contrasts for these factors in `my_data` don't match formulas:</span></span>
<span><span class="co">#&gt;  - carb</span></span>
<span><span class="co">#&gt; Comparison labels for contrasts in `my_data` don't match:</span></span>
<span><span class="co">#&gt;  - cyl   (expected `6, 8` but found `2, 3`)</span></span>
<span><span class="co">#&gt;  - am    (expected `diffLabel` but found `1`)</span></span>
<span><span class="co">#&gt; To fix, be sure to run:</span></span>
<span><span class="co">#&gt; my_data &lt;- set_contrasts(my_data, </span></span>
<span><span class="co">#&gt;                          cyl ~ sum_code,</span></span>
<span><span class="co">#&gt;                          carb ~ sum_code,</span></span>
<span><span class="co">#&gt;                          gear ~ sum_code,</span></span>
<span><span class="co">#&gt;                          am ~ treatment_code | c("diffLabel"))</span></span>
<span><span class="co">#&gt;   factor n  level_names         scheme reference  intercept</span></span>
<span><span class="co">#&gt; 1    cyl 3      4, 6, 8       sum_code      &lt;NA&gt; grand mean</span></span>
<span><span class="co">#&gt; 2   carb 6 1, 2, 3,....       sum_code      &lt;NA&gt; grand mean</span></span>
<span><span class="co">#&gt; 3   gear 3      3, 4, 5       sum_code      &lt;NA&gt; grand mean</span></span>
<span><span class="co">#&gt; 4     am 2         0, 1 treatment_code      &lt;NA&gt;    mean(0)</span></span></code></pre></div>
<p>Currently, <code>glimpse_contrasts</code> depends on being provided
with the desired contrast formulas/matrices to provide a summary table
correctly. If you set the contrasts, then try to summarize the dataframe
without the the same formulas, then you’ll get a warning that the factor
(whether unordered or ordered) does not match the default contrasts that
would normally be expected. In the example below, the contrasts are set
to <code>sum_code</code>, but because the default contrasts for
unordered factors is <code>contr.treatment</code>, the contrast matrices
won’t match for <code>my_data$cyl</code>. The scheme will be reported as
<code>"???"</code></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_contrasts.html">set_contrasts</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="va">cyl</span> <span class="op">~</span> <span class="va">sum_code</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/glimpse_contrasts.html">glimpse_contrasts</a></span><span class="op">(</span><span class="va">my_data</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in .warn_if_nondefault(default_contrasts, unset_factors, factor_sizes, : Unset factors do not use default <span style="color: #0000BB;">contr.treatment</span> or <span style="color: #BB0000;">contr.poly</span>. Glimpse table may be unreliable.</span></span>
<span><span class="co">#&gt;  - <span style="color: #0000BB;">cyl</span></span></span>
<span><span class="co">#&gt;     factor n level_names scheme reference  intercept orthogonal centered</span></span>
<span><span class="co">#&gt; cyl    cyl 3     4, 6, 8    ???         4 grand mean         NA       NA</span></span>
<span><span class="co">#&gt;     dropped_trends explicitly_set</span></span>
<span><span class="co">#&gt; cyl             NA          FALSE</span></span></code></pre></div>
<p>Currently, there is not an elegant way for
<code>glimpse_contrasts</code> to check what the contrast scheme is
based solely on the resulting matrix. Moreover, many contrast schemes
are the same when the number of levels is 2, meaning that a matrix of
<code>+.5/-.5</code> could be <code>scaled_sum_code</code> or
<code>helmert_code</code> (among others). I’m also reluctant to add
additional attributes to the dataframe for the sole purpose of
<code>glimpse_contrasts</code> being able to summarize things.</p>
<p>The most robust solution if you want to make use of
<code>glimpse_contrasts</code> is to specify a list of contrast
matrices, then pass the list to <code>set_contrasts</code> and
<code>glimpse_contrasts</code>.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">contrast_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">cyl</span> <span class="op">~</span> <span class="va">scaled_sum_code</span>, </span>
<span>                      <span class="va">carb</span> <span class="op">~</span> <span class="va">sum_code</span>, </span>
<span>                      <span class="va">gear</span> <span class="op">~</span> <span class="va">sum_code</span>,</span>
<span>                      <span class="va">am</span> <span class="op">~</span> <span class="va">treatment_code</span> <span class="op">|</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"diffLabel"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">my_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_contrasts.html">set_contrasts</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="va">contrast_list</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/glimpse_contrasts.html">glimpse_contrasts</a></span><span class="op">(</span><span class="va">my_data</span>, <span class="va">contrast_list</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="errors">Errors<a class="anchor" aria-label="anchor" href="#errors"></a>
</h2>
<p>Here are some common errors, though not all of them are errors from
contrastable per se.</p>
<p>You’ll receive an error if you use a matrix that’s a different size
from what the contrast matrix should be. Specifically, contrasts
matrices for a factor with n levels should be size
<code>nx(n-1)</code>.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sum_code.html">sum_code</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu"><a href="../reference/set_contrasts.html">set_contrasts</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="va">cyl</span> <span class="op">~</span> <span class="va">my_matrix</span><span class="op">)</span><span class="op">)</span> <span class="co"># cyl has 3 levels, not 4</span></span>
<span><span class="co">#&gt; Converting to factors: <span style="color: #0000BB;">cyl</span></span></span>
<span><span class="co">#&gt; Error in use_contrasts.matrix(factor_col = get(params[["factor_col"]],  : </span></span>
<span><span class="co">#&gt;   Matrix given to code_by is size 4x3 but factor_col contrast matrix is size 3x2.</span></span></code></pre></div>
<p>You’ll receive an error if you try to set the reference level (or
intercept) to a level that doesn’t exist in the factor.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu"><a href="../reference/set_contrasts.html">set_contrasts</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="va">cyl</span> <span class="op">~</span> <span class="va">sum_code</span> <span class="op">+</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Converting to factors: <span style="color: #0000BB;">cyl</span></span></span>
<span><span class="co">#&gt; Error in .switch_reference_if_needed(new_contrasts, reference_level, new_reference_index) : </span></span>
<span><span class="co">#&gt;   Reference level not found in factor levels</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu"><a href="../reference/set_contrasts.html">set_contrasts</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="va">cyl</span> <span class="op">~</span> <span class="va">sum_code</span> <span class="op">*</span> <span class="st">"blah"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Converting to factors: <span style="color: #0000BB;">cyl</span></span></span>
<span><span class="co">#&gt; Error in .set_intercept(new_contrasts, set_intercept) : </span></span>
<span><span class="co">#&gt;   Specified level to use as intercept not found in factor level names</span></span></code></pre></div>
<p>You’ll receive an error if you accidentally use <code>=</code>
instead of <code>~</code></p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu"><a href="../reference/set_contrasts.html">set_contrasts</a></span><span class="op">(</span><span class="va">mtcars</span>, cyl <span class="op">=</span> <span class="va">sum_code</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error : In `base::tryCatch(base::withCallingHandlers({     NULL     base::sa...`: </span></span>
<span><span class="co">#&gt; `x` must be a formula</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Did you use = instead of ~ when setting the contrast?</span></span></code></pre></div>
<p>You’ll receive an error if you accidentally specify contrasts for the
same variable more than once:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu"><a href="../reference/set_contrasts.html">set_contrasts</a></span><span class="op">(</span><span class="va">mtcars</span>,</span>
<span>                  <span class="va">cyl</span> <span class="op">~</span> <span class="va">sum_code</span>, </span>
<span>                  <span class="va">cyl</span> <span class="op">~</span> <span class="va">scaled_sum_code</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error : In `base::tryCatch(base::withCallingHandlers({     NULL     base::sa...`: </span></span>
<span><span class="co">#&gt; Names must be unique.</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> These names are duplicated:</span></span>
<span><span class="co">#&gt;   * "cyl" at locations 1 and 2.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Left hand side of multiple formulas evaluated to the same column name</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu"><a href="../reference/set_contrasts.html">set_contrasts</a></span><span class="op">(</span><span class="va">mtcars</span>, </span>
<span>                  <span class="va">cyl</span> <span class="op">+</span> <span class="va">gear</span> <span class="op">~</span> <span class="va">sum_code</span>,</span>
<span>                  <span class="va">cyl</span> <span class="op">~</span> <span class="va">scaled_sum_code</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error : In `base::tryCatch(base::withCallingHandlers({     NULL     base::sa...`: </span></span>
<span><span class="co">#&gt; Names must be unique.</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> These names are duplicated:</span></span>
<span><span class="co">#&gt;   * "cyl" at locations 1 and 3.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Left hand side of multiple formulas evaluated to the same column name</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu"><a href="../reference/set_contrasts.html">set_contrasts</a></span><span class="op">(</span><span class="va">mtcars</span>, </span>
<span>                  <span class="fu"><a href="https://tidyselect.r-lib.org/reference/where.html" class="external-link">where</a></span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span> <span class="op">~</span> <span class="va">sum_code</span>, </span>
<span>                  <span class="va">cyl</span> <span class="op">~</span> <span class="va">scaled_sum_code</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error : In `base::tryCatch(base::withCallingHandlers({     NULL     base::sa...`: </span></span>
<span><span class="co">#&gt; Names must be unique.</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> These names are duplicated:</span></span>
<span><span class="co">#&gt;   * "cyl" at locations 2 and 12.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Left hand side of multiple formulas evaluated to the same column name</span></span>
<span></span>
<span><span class="va">these_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cyl"</span>, <span class="st">"gear"</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu"><a href="../reference/set_contrasts.html">set_contrasts</a></span><span class="op">(</span><span class="va">mtcars</span>, </span>
<span>                  <span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html" class="external-link">all_of</a></span><span class="op">(</span><span class="va">these_vars</span><span class="op">)</span> <span class="op">~</span> <span class="va">sum_code</span>, </span>
<span>                  <span class="fu"><a href="https://tidyselect.r-lib.org/reference/where.html" class="external-link">where</a></span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span> <span class="op">~</span> <span class="va">scaled_sum_code</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error : In `base::tryCatch(base::withCallingHandlers({     NULL     base::sa...`: </span></span>
<span><span class="co">#&gt; Names must be unique.</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> These names are duplicated:</span></span>
<span><span class="co">#&gt;   * "cyl" at locations 1 and 4.</span></span>
<span><span class="co">#&gt;   * "gear" at locations 2 and 12.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Left hand side of multiple formulas evaluated to the same column name</span></span></code></pre></div>
<p>You’ll receive an error if you accidentally forget to pass the
dataframe:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu"><a href="../reference/set_contrasts.html">set_contrasts</a></span><span class="op">(</span><span class="va">cyl</span> <span class="op">~</span> <span class="va">sum_code</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in enlist_contrasts(model_data, !!!formulas, verbose = verbose) : </span></span>
<span><span class="co">#&gt;   Formula passed to model_data, did you forget to pass a data frame?</span></span></code></pre></div>
<p>You’ll receive an error if you forget to pass any contrasts
formulas:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu"><a href="../reference/set_contrasts.html">set_contrasts</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in .warn_if_onelevel(lhs_variables[is_onelevel_factor]) : </span></span>
<span><span class="co">#&gt;   If factor names are not provided, the model data and factors being set must be provided</span></span></code></pre></div>
<p>Variables with only one level will be ignored, but you’ll receive an
error if there are no remaining variables with more than one level
(i.e., if you <em>only</em> specify one-level factors). Note that you’ll
still get the warning message.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu"><a href="../reference/set_contrasts.html">set_contrasts</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                  <span class="va">a</span> <span class="op">~</span> <span class="va">sum_code</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Contrasts undefined for factors with only one level: <span style="color: #00BBBB;">a</span></span></span>
<span><span class="co">#&gt; Error in enlist_contrasts(model_data, !!!formulas, verbose = verbose) : </span></span>
<span><span class="co">#&gt;   No factors with more than 1 level found</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Thomas Sostarics.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
