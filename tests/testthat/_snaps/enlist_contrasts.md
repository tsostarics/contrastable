# Check that implementation of contrast functions remains the same

    Code
      sapply(schemes, function(s) {
        fx <- sym(s)
        cmat <- rlang::inject(enlist_contrasts(tstdata_2, x ~ !!fx))
        cmat <- as.character(MASS::fractions(cmat[[1L]]))
        list(cmat)
      })
    Output
      $sum_code
        2   
      1 "-1"
      2 "1" 
      
      $treatment_code
        2  
      1 "0"
      2 "1"
      
      $scaled_sum_code
        2     
      1 "-1/2"
      2 "1/2" 
      
      $cumulative_split_code
        1|2   
      1 "-1/2"
      2 "1/2" 
      
      $helmert_code
        <2    
      1 "-1/2"
      2 "1/2" 
      
      $reverse_helmert_code
        >1    
      1 "-1/2"
      2 "1/2" 
      
      $backward_difference_code
        2-1   
      1 "-1/2"
      2 "1/2" 
      
      $forward_difference_code
        1-2   
      1 "-1/2"
      2 "1/2" 
      
      $polynomial_code
        .L          
      1 "-5741/8119"
      2 "2378/3363" 
      
      $raw_polynomial_code
        .L 
      1 "1"
      2 "2"
      

---

    Code
      sapply(schemes, function(s) {
        fx <- sym(s)
        cmat <- suppressWarnings(rlang::inject(enlist_contrasts(tstdata_2, x ~ !!fx +
          2)))
        cmat <- as.character(MASS::fractions(cmat[[1L]]))
        list(cmat)
      })
    Output
      $sum_code
        1   
      1 "1" 
      2 "-1"
      
      $treatment_code
        1  
      1 "1"
      2 "0"
      
      $scaled_sum_code
        1     
      1 "1/2" 
      2 "-1/2"
      
      $cumulative_split_code
        1|2   
      1 "1/2" 
      2 "-1/2"
      
      $helmert_code
        <2    
      1 "1/2" 
      2 "-1/2"
      
      $reverse_helmert_code
        >1    
      1 "1/2" 
      2 "-1/2"
      
      $backward_difference_code
        2-1   
      1 "1/2" 
      2 "-1/2"
      
      $forward_difference_code
        1-2   
      1 "1/2" 
      2 "-1/2"
      
      $polynomial_code
        .L          
      1 "2378/3363" 
      2 "-5741/8119"
      
      $raw_polynomial_code
        .L 
      1 "1"
      2 "2"
      

---

    Code
      sapply(schemes, function(s) {
        fx <- sym(s)
        cmat <- rlang::inject(enlist_contrasts(tstdata_2, x ~ !!fx * 2))
        cmat <- as.character(MASS::fractions(cmat[[1L]]))
        list(cmat)
      })
    Output
      $sum_code
        2   
      1 "-2"
      2 "0" 
      
      $treatment_code
        2   
      1 "-1"
      2 "0" 
      
      $scaled_sum_code
        2   
      1 "-1"
      2 "0" 
      
      $cumulative_split_code
        1|2 
      1 "-1"
      2 "0" 
      
      $helmert_code
        <2  
      1 "-1"
      2 "0" 
      
      $reverse_helmert_code
        >1  
      1 "-1"
      2 "0" 
      
      $backward_difference_code
        2-1 
      1 "-1"
      2 "0" 
      
      $forward_difference_code
        1-2 
      1 "-1"
      2 "0" 
      
      $polynomial_code
        .L          
      1 "-3363/2378"
      2 "0"         
      
      $raw_polynomial_code
        .L  
      1 "-1"
      2 "0" 
      

---

    Code
      sapply(schemes, function(s) {
        fx <- sym(s)
        cmat <- rlang::inject(enlist_contrasts(tstdata_5, x ~ !!fx))
        cmat <- as.character(MASS::fractions(cmat[[1L]]))
        list(cmat)
      })
    Output
      $sum_code
        2    3    4    5   
      1 "-1" "-1" "-1" "-1"
      2 "1"  "0"  "0"  "0" 
      3 "0"  "1"  "0"  "0" 
      4 "0"  "0"  "1"  "0" 
      5 "0"  "0"  "0"  "1" 
      
      $treatment_code
        2   3   4   5  
      1 "0" "0" "0" "0"
      2 "1" "0" "0" "0"
      3 "0" "1" "0" "0"
      4 "0" "0" "1" "0"
      5 "0" "0" "0" "1"
      
      $scaled_sum_code
        2      3      4      5     
      1 "-1/5" "-1/5" "-1/5" "-1/5"
      2 "4/5"  "-1/5" "-1/5" "-1/5"
      3 "-1/5" "4/5"  "-1/5" "-1/5"
      4 "-1/5" "-1/5" "4/5"  "-1/5"
      5 "-1/5" "-1/5" "-1/5" "4/5" 
      
      $cumulative_split_code
        1|2    2|3    3|4    4|5   
      1 "4/5"  "0"    "0"    "0"   
      2 "-4/5" "6/5"  "0"    "0"   
      3 "0"    "-6/5" "6/5"  "0"   
      4 "0"    "0"    "-6/5" "4/5" 
      5 "0"    "0"    "0"    "-4/5"
      
      $helmert_code
        <2     <3     <4     <5    
      1 "-1/2" "-1/3" "-1/4" "-1/5"
      2 "1/2"  "-1/3" "-1/4" "-1/5"
      3 "0"    "2/3"  "-1/4" "-1/5"
      4 "0"    "0"    "3/4"  "-1/5"
      5 "0"    "0"    "0"    "4/5" 
      
      $reverse_helmert_code
        >1     >2     >3     >4    
      1 "4/5"  "0"    "0"    "0"   
      2 "-1/5" "3/4"  "0"    "0"   
      3 "-1/5" "-1/4" "2/3"  "0"   
      4 "-1/5" "-1/4" "-1/3" "1/2" 
      5 "-1/5" "-1/4" "-1/3" "-1/2"
      
      $backward_difference_code
        2-1    3-2    4-3    5-4   
      1 "-4/5" "-3/5" "-2/5" "-1/5"
      2 "1/5"  "-3/5" "-2/5" "-1/5"
      3 "1/5"  "2/5"  "-2/5" "-1/5"
      4 "1/5"  "2/5"  "3/5"  "-1/5"
      5 "1/5"  "2/5"  "3/5"  "4/5" 
      
      $forward_difference_code
        1-2    2-3    3-4    4-5   
      1 "4/5"  "3/5"  "2/5"  "1/5" 
      2 "-1/5" "3/5"  "2/5"  "1/5" 
      3 "-1/5" "-2/5" "2/5"  "1/5" 
      4 "-1/5" "-2/5" "-3/5" "1/5" 
      5 "-1/5" "-2/5" "-3/5" "-4/5"
      
      $polynomial_code
        .L                  .Q            .C                  ^4              
      1 "-265/419"          "929/1738"    "-2026009/6406803"  "4018/33617"    
      2 "-2026009/6406803"  "-809/3027"   "191/302"           "-246481/515552"
      3 "0"                 "-6263/11717" "0"                 "1042/1453"     
      4 "10458821/33073696" "-809/3027"   "-265/419"          "-246481/515552"
      5 "191/302"           "929/1738"    "10458821/33073696" "4018/33617"    
      
      $raw_polynomial_code
        .L  .Q   .C    ^4   
      1 "1" "1"  "1"   "1"  
      2 "2" "4"  "8"   "16" 
      3 "3" "9"  "27"  "81" 
      4 "4" "16" "64"  "256"
      5 "5" "25" "125" "625"
      

---

    Code
      sapply(schemes, function(s) {
        fx <- sym(s)
        cmat <- rlang::inject(enlist_contrasts(tstdata_5, x ~ !!fx * 3))
        cmat <- as.character(MASS::fractions(cmat[[1L]]))
        list(cmat)
      })
    Output
      $sum_code
        2    3    4    5   
      1 "-1" "-2" "-1" "-1"
      2 "1"  "-1" "0"  "0" 
      3 "0"  "0"  "0"  "0" 
      4 "0"  "-1" "1"  "0" 
      5 "0"  "-1" "0"  "1" 
      
      $treatment_code
        2   3    4   5  
      1 "0" "-1" "0" "0"
      2 "1" "-1" "0" "0"
      3 "0" "0"  "0" "0"
      4 "0" "-1" "1" "0"
      5 "0" "-1" "0" "1"
      
      $scaled_sum_code
        2   3    4   5  
      1 "0" "-1" "0" "0"
      2 "1" "-1" "0" "0"
      3 "0" "0"  "0" "0"
      4 "0" "-1" "1" "0"
      5 "0" "-1" "0" "1"
      
      $cumulative_split_code
        1|2    2|3    3|4     4|5   
      1 "4/5"  "6/5"  "-6/5"  "0"   
      2 "-4/5" "12/5" "-6/5"  "0"   
      3 "0"    "0"    "0"     "0"   
      4 "0"    "6/5"  "-12/5" "4/5" 
      5 "0"    "6/5"  "-6/5"  "-4/5"
      
      $helmert_code
        <2     <3     <4    <5 
      1 "-1/2" "-1"   "0"   "0"
      2 "1/2"  "-1"   "0"   "0"
      3 "0"    "0"    "0"   "0"
      4 "0"    "-2/3" "1"   "0"
      5 "0"    "-2/3" "1/4" "1"
      
      $reverse_helmert_code
        >1  >2    >3     >4    
      1 "1" "1/4" "-2/3" "0"   
      2 "0" "1"   "-2/3" "0"   
      3 "0" "0"   "0"    "0"   
      4 "0" "0"   "-1"   "1/2" 
      5 "0" "0"   "-1"   "-1/2"
      
      $backward_difference_code
        2-1  3-2  4-3 5-4
      1 "-1" "-1" "0" "0"
      2 "0"  "-1" "0" "0"
      3 "0"  "0"  "0" "0"
      4 "0"  "0"  "1" "0"
      5 "0"  "0"  "1" "1"
      
      $forward_difference_code
        1-2 2-3 3-4  4-5 
      1 "1" "1" "0"  "0" 
      2 "0" "1" "0"  "0" 
      3 "0" "0" "0"  "0" 
      4 "0" "0" "-1" "0" 
      5 "0" "0" "-1" "-1"
      
      $polynomial_code
        .L                  .Q                  .C                 
      1 "-265/419"          "12916816/12082575" "-2026009/6406803" 
      2 "-2026009/6406803"  "929/3476"          "191/302"          
      3 "0"                 "0"                 "0"                
      4 "10458821/33073696" "929/3476"          "-265/419"         
      5 "191/302"           "12916816/12082575" "10458821/33073696"
        ^4                
      1 "-50701/84839"    
      2 "-1509006/1262525"
      3 "0"               
      4 "-1509006/1262525"
      5 "-50701/84839"    
      
      $raw_polynomial_code
        .L   .Q   .C    ^4   
      1 "-2" "-8" "-26" "-80"
      2 "-1" "-5" "-19" "-65"
      3 "0"  "0"  "0"   "0"  
      4 "1"  "7"  "37"  "175"
      5 "2"  "16" "98"  "544"
      

---

    Code
      sapply(schemes, function(s) {
        fx <- sym(s)
        cmat <- suppressWarnings(rlang::inject(enlist_contrasts(tstdata_5, x ~ !!fx +
          3)))
        cmat <- as.character(MASS::fractions(cmat[[1L]]))
        list(cmat)
      })
    Output
      $sum_code
        1    2    4    5   
      1 "1"  "0"  "0"  "0" 
      2 "0"  "1"  "0"  "0" 
      3 "-1" "-1" "-1" "-1"
      4 "0"  "0"  "1"  "0" 
      5 "0"  "0"  "0"  "1" 
      
      $treatment_code
        1   2   4   5  
      1 "1" "0" "0" "0"
      2 "0" "1" "0" "0"
      3 "0" "0" "0" "0"
      4 "0" "0" "1" "0"
      5 "0" "0" "0" "1"
      
      $scaled_sum_code
        1      2      4      5     
      1 "4/5"  "-1/5" "-1/5" "-1/5"
      2 "-1/5" "4/5"  "-1/5" "-1/5"
      3 "-1/5" "-1/5" "-1/5" "-1/5"
      4 "-1/5" "-1/5" "4/5"  "-1/5"
      5 "-1/5" "-1/5" "-1/5" "4/5" 
      
      $cumulative_split_code
        1|2    2|3    3|4    4|5   
      1 "4/5"  "0"    "0"    "0"   
      2 "-4/5" "6/5"  "0"    "0"   
      3 "0"    "-6/5" "6/5"  "0"   
      4 "0"    "0"    "-6/5" "4/5" 
      5 "0"    "0"    "0"    "-4/5"
      
      $helmert_code
        <2     <3     <4     <5    
      1 "-1/2" "-1/3" "-1/4" "-1/5"
      2 "1/2"  "-1/3" "-1/4" "-1/5"
      3 "0"    "2/3"  "-1/4" "-1/5"
      4 "0"    "0"    "3/4"  "-1/5"
      5 "0"    "0"    "0"    "4/5" 
      
      $reverse_helmert_code
        >1     >2     >3     >4    
      1 "4/5"  "0"    "0"    "0"   
      2 "-1/5" "3/4"  "0"    "0"   
      3 "-1/5" "-1/4" "2/3"  "0"   
      4 "-1/5" "-1/4" "-1/3" "1/2" 
      5 "-1/5" "-1/4" "-1/3" "-1/2"
      
      $backward_difference_code
        2-1    3-2    4-3    5-4   
      1 "-4/5" "-3/5" "-2/5" "-1/5"
      2 "1/5"  "-3/5" "-2/5" "-1/5"
      3 "1/5"  "2/5"  "-2/5" "-1/5"
      4 "1/5"  "2/5"  "3/5"  "-1/5"
      5 "1/5"  "2/5"  "3/5"  "4/5" 
      
      $forward_difference_code
        1-2    2-3    3-4    4-5   
      1 "4/5"  "3/5"  "2/5"  "1/5" 
      2 "-1/5" "3/5"  "2/5"  "1/5" 
      3 "-1/5" "-2/5" "2/5"  "1/5" 
      4 "-1/5" "-2/5" "-3/5" "1/5" 
      5 "-1/5" "-2/5" "-3/5" "-4/5"
      
      $polynomial_code
        .L                  .Q            .C                  ^4              
      1 "-265/419"          "929/1738"    "-2026009/6406803"  "4018/33617"    
      2 "-2026009/6406803"  "-809/3027"   "191/302"           "-246481/515552"
      3 "0"                 "-6263/11717" "0"                 "1042/1453"     
      4 "10458821/33073696" "-809/3027"   "-265/419"          "-246481/515552"
      5 "191/302"           "929/1738"    "10458821/33073696" "4018/33617"    
      
      $raw_polynomial_code
        .L  .Q   .C    ^4   
      1 "1" "1"  "1"   "1"  
      2 "2" "4"  "8"   "16" 
      3 "3" "9"  "27"  "81" 
      4 "4" "16" "64"  "256"
      5 "5" "25" "125" "625"
      

